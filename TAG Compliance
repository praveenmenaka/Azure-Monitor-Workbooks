{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "loadType": "always",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "<img src=\"https://www.unilever.com/core-assets/logos/logo-animated.svg\" alt=\"HCLTech\" width=\"120\" height=\"140\">"
            },
            "customWidth": "10",
            "name": "text - 19",
            "styleSettings": {
              "margin": "10",
              "padding": "10",
              "maxWidth": "10"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "<h1>Tags</h1>\r\n<h2>Compliance status</h2>\r\n___________________________________________________________________________________________________________________\r\n"
            },
            "customWidth": "90",
            "name": "text - 19 - Copy",
            "styleSettings": {
              "maxWidth": "90",
              "showBorder": true
            }
          },
          {
            "type": 1,
            "content": {
              "json": "________________________________________________________________________________________________________________________________________________________________________________________________________"
            },
            "name": "text - 15 - Copy - Copy - Copy"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "7a08fb1f-59df-49e3-b4f8-c2de5e2f3862",
                  "version": "KqlParameterItem/1.0",
                  "name": "Subscriptions",
                  "type": 6,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "includeAll": true,
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": [
                    "/subscriptions/b466d563-74e6-4232-a5c6-f39f65f6f1fc"
                  ]
                }
              ],
              "style": "formHorizontal",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 22"
          },
          {
            "type": 1,
            "content": {
              "json": ""
            },
            "customWidth": "40",
            "name": "text - 23",
            "styleSettings": {
              "maxWidth": "40"
            }
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "id": "0927cf1c-2379-48ed-adda-feadcfbdd5bf",
                  "cellValue": "selectedTab",
                  "linkTarget": "parameter",
                  "linkLabel": "Virtual Machines",
                  "subTarget": "Virtual Machines",
                  "style": "primary"
                },
                {
                  "id": "addc3aa6-83dc-4703-a2c0-a250bf6b1fb5",
                  "cellValue": "selectedTab",
                  "linkTarget": "parameter",
                  "linkLabel": "Resource Groups",
                  "subTarget": "Resource Groups",
                  "style": "primary"
                }
              ]
            },
            "customWidth": "50",
            "name": "links - 22",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Virtual Machines",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "0d2b4000-be45-4212-943b-75fe706f126b",
                        "cellValue": "selectedTab",
                        "linkTarget": "parameter",
                        "linkLabel": "Overall Summary",
                        "subTarget": "Overall Summary",
                        "style": "link"
                      },
                      {
                        "id": "deada350-4c6a-4936-8904-f45f11a3297e",
                        "cellValue": "selectedTab",
                        "linkTarget": "parameter",
                        "linkLabel": "Individual Summary",
                        "subTarget": "Individual Summary",
                        "style": "link"
                      },
                      {
                        "id": "21591b99-4d5c-4139-98e6-9b9517999fc7",
                        "cellValue": "selectedTab",
                        "linkTarget": "parameter",
                        "linkLabel": "Count",
                        "subTarget": "Count",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 8"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Name",
                          "size": 3,
                          "title": "Name",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "Name",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by ServiceName",
                          "size": 3,
                          "title": "ServiceName",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "ServiceName",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by BAU",
                          "size": 3,
                          "title": "BAU",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "BAU",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by ITSG",
                          "size": 3,
                          "title": "ITSG",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "ITSG",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "___________________________________________________________________________________________________________________________________________"
                        },
                        "name": "text - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue) and tagKey == \"CostCentre\"\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server, tagValue\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\" and tagValue startswith \"A956\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by CostCentre",
                          "size": 3,
                          "title": "CostCentre",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "gridSettings": {
                            "rowLimit": 10000,
                            "filter": true
                          },
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "CostCentre",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Icc",
                          "size": 3,
                          "title": "Icc",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "Icc",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Platform",
                          "size": 3,
                          "title": "Platform",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "Platform",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Environment",
                          "size": 3,
                          "title": "Environment",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "Environment",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "___________________________________________________________________________________________________________________________________________"
                        },
                        "name": "text - 13 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by OptInOptOut",
                          "size": 3,
                          "title": "OptInOptOut",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "OptInOptOut",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Exclude_PMC",
                          "size": 3,
                          "title": "Exclude_PMC",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "Exclude_PMC",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by License",
                          "size": 3,
                          "title": "License",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "License",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Workload",
                          "size": 3,
                          "title": "Workload",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "Workload",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "___________________________________________________________________________________________________________________________________________"
                        },
                        "name": "text - 13 - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by ProductVersion",
                          "size": 3,
                          "title": "ProductVersion",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "ProductVersion",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "selectedTab",
                    "comparison": "isEqualTo",
                    "value": "Overall Summary"
                  },
                  "name": "Overall Summary",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "nav",
                          "links": [
                            {
                              "id": "2a1cb1a6-e665-468f-a692-7319ecb2dc0e",
                              "cellValue": "Name",
                              "linkTarget": "step",
                              "linkLabel": "Name",
                              "preText": "",
                              "style": "link"
                            },
                            {
                              "id": "e74512d0-eaf8-40b9-b259-eed5cd2e9288",
                              "cellValue": "ServiceName",
                              "linkTarget": "step",
                              "linkLabel": "ServiceName",
                              "style": "link"
                            },
                            {
                              "id": "4e1d7e13-6c41-4110-bd7b-c51a22fd5b50",
                              "cellValue": "BAU",
                              "linkTarget": "step",
                              "linkLabel": "BAU",
                              "style": "link"
                            },
                            {
                              "id": "dadd786f-378e-4473-9b38-0f960cc6f528",
                              "cellValue": "ITSG",
                              "linkTarget": "step",
                              "linkLabel": "ITSG",
                              "style": "link"
                            },
                            {
                              "id": "bdc908bc-19eb-48ee-be93-ad9d14bad843",
                              "cellValue": "CostCentre",
                              "linkTarget": "step",
                              "linkLabel": "CostCentre",
                              "style": "link"
                            },
                            {
                              "id": "d0aa9961-c7a7-4f76-ab48-18a83bd3da28",
                              "cellValue": "Icc",
                              "linkTarget": "step",
                              "linkLabel": "Icc",
                              "style": "link"
                            },
                            {
                              "id": "a06bb035-cddf-489e-8a34-cf2ed340544c",
                              "cellValue": "Platform",
                              "linkTarget": "step",
                              "linkLabel": "Platform",
                              "style": "link"
                            },
                            {
                              "id": "20b7bebb-7510-424c-91a0-6a06e63448a6",
                              "cellValue": "Environment",
                              "linkTarget": "step",
                              "linkLabel": "Environment",
                              "style": "link"
                            },
                            {
                              "id": "47cc0c1f-c0b9-4f51-b84c-691a6a6ec51e",
                              "cellValue": "OptInOptOut",
                              "linkTarget": "step",
                              "linkLabel": "OptInOptOut",
                              "style": "link"
                            },
                            {
                              "id": "4853c47c-f5a1-43ec-a69d-5d9bff5c8aa0",
                              "cellValue": "Exclude_PMC",
                              "linkTarget": "step",
                              "linkLabel": "Exclude_PMC",
                              "style": "link"
                            },
                            {
                              "id": "ea962198-909c-4d11-960c-8d338f304a7d",
                              "cellValue": "License",
                              "linkTarget": "step",
                              "linkLabel": "License",
                              "style": "link"
                            },
                            {
                              "id": "86547438-03fc-43d2-a71f-411933b57ed4",
                              "cellValue": "Workload",
                              "linkTarget": "step",
                              "linkLabel": "Workload",
                              "style": "link"
                            },
                            {
                              "id": "e108180a-219f-4cf0-b36d-1331c332390f",
                              "cellValue": "ProductVersion",
                              "linkTarget": "step",
                              "linkLabel": "ProductVersion",
                              "style": "link"
                            }
                          ]
                        },
                        "name": "Scroll to step - Top"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "Name",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Name",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server,id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| where Name == {selectedNameTag}\r\n| project Server, [\"Tag Status\"]=Name, id",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name - Copy",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "Name",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "ServiceName",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by ServiceName",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server,id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| where ServiceName == {selectedNameTag}\r\n| project Server, [\"Tag Status\"]=ServiceName, id",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name - Copy",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "ServiceName",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "BAU",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by BAU",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server,id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| where BAU == {selectedNameTag}\r\n| project Server, [\"Tag Status\"]=BAU, id",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name - Copy",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "BAU",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "ITSG",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by ITSG",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server,id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| where ITSG == {selectedNameTag}\r\n| project Server, [\"Tag Status\"]=ITSG, id",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "ITSG",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "ITSG",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "CostCentre",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by CostCentre",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server,id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| where CostCentre == {selectedNameTag}\r\n| project Server, [\"Tag Status\"]=CostCentre, id",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "ITSG",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "CostCentre",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "Icc",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Icc",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server,id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| where Icc == {selectedNameTag}\r\n| project Server, [\"Tag Status\"]=Icc, id",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "ITSG",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "Icc",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "Platform",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Platform",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server,id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| where Platform == {selectedNameTag}\r\n| project Server, [\"Tag Status\"]=Platform, id\r\n",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "ITSG",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "Platform",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "Environment",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Environment",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server,id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| where Environment == {selectedNameTag}\r\n| project Server, [\"Tag Status\"]=Environment, id\r\n\r\n",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Environment",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "Environment",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "OptInOptOut",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by OptInOptOut",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server,id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| where OptInOptOut == {selectedNameTag}\r\n| project Server, [\"Tag Status\"]=OptInOptOut, id\r\n\r\n",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Environment",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "OptInOptOut",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "Exclude_PMC",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Exclude_PMC",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server,id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| where Exclude_PMC == {selectedNameTag}\r\n| project Server, [\"Tag Status\"]=Exclude_PMC, id\r\n\r\n",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Environment",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "Exclude_PMC",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "License",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by License",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server,id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| where License == {selectedNameTag}\r\n| project Server, [\"Tag Status\"]=License, id\r\n\r\n",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Environment",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "License",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "Workload",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Workload",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server,id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| where Workload == {selectedNameTag}\r\n| project Server, [\"Tag Status\"]=Workload, id\r\n\r\n",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Environment",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "Workload",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "ProductVersion",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by ProductVersion",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags, id\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"BAU\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"OptInOptOut\", \"Exclude_PMC\", \"License\", \"Workload\", \"ProductVersion\")\r\n| where isnotnull(tagValue) and isnotempty(tagValue)\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by Server,id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t BAU = case(M_tags_set has \"BAU\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t OptInOptOut = case(M_tags_set has \"OptInOptOut\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Exclude_PMC = case(M_tags_set has \"Exclude_PMC\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t License = case(M_tags_set has \"License\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ProductVersion = case(M_tags_set has \"ProductVersion\", \"Compliant\", \"Non-Compliant\")\r\n| where ProductVersion == {selectedNameTag}\r\n| project Server, [\"Tag Status\"]=ProductVersion, id\r\n\r\n",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Environment",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "ProductVersion",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "nav",
                          "links": [
                            {
                              "id": "2a1cb1a6-e665-468f-a692-7319ecb2dc0e",
                              "cellValue": "Name",
                              "linkTarget": "step",
                              "linkLabel": "Name",
                              "preText": "",
                              "style": "link"
                            },
                            {
                              "id": "e74512d0-eaf8-40b9-b259-eed5cd2e9288",
                              "cellValue": "ServiceName",
                              "linkTarget": "step",
                              "linkLabel": "ServiceName",
                              "style": "link"
                            },
                            {
                              "id": "4e1d7e13-6c41-4110-bd7b-c51a22fd5b50",
                              "cellValue": "BAU",
                              "linkTarget": "step",
                              "linkLabel": "BAU",
                              "style": "link"
                            },
                            {
                              "id": "dadd786f-378e-4473-9b38-0f960cc6f528",
                              "cellValue": "ITSG",
                              "linkTarget": "step",
                              "linkLabel": "ITSG",
                              "style": "link"
                            },
                            {
                              "id": "bdc908bc-19eb-48ee-be93-ad9d14bad843",
                              "cellValue": "CostCentre",
                              "linkTarget": "step",
                              "linkLabel": "CostCentre",
                              "style": "link"
                            },
                            {
                              "id": "d0aa9961-c7a7-4f76-ab48-18a83bd3da28",
                              "cellValue": "Icc",
                              "linkTarget": "step",
                              "linkLabel": "Icc",
                              "style": "link"
                            },
                            {
                              "id": "a06bb035-cddf-489e-8a34-cf2ed340544c",
                              "cellValue": "Platform",
                              "linkTarget": "step",
                              "linkLabel": "Platform",
                              "style": "link"
                            },
                            {
                              "id": "20b7bebb-7510-424c-91a0-6a06e63448a6",
                              "cellValue": "Environment",
                              "linkTarget": "step",
                              "linkLabel": "Environment",
                              "style": "link"
                            },
                            {
                              "id": "47cc0c1f-c0b9-4f51-b84c-691a6a6ec51e",
                              "cellValue": "OptInOptOut",
                              "linkTarget": "step",
                              "linkLabel": "OptInOptOut",
                              "style": "link"
                            },
                            {
                              "id": "4853c47c-f5a1-43ec-a69d-5d9bff5c8aa0",
                              "cellValue": "Exclude_PMC",
                              "linkTarget": "step",
                              "linkLabel": "Exclude_PMC",
                              "style": "link"
                            },
                            {
                              "id": "ea962198-909c-4d11-960c-8d338f304a7d",
                              "cellValue": "License",
                              "linkTarget": "step",
                              "linkLabel": "License",
                              "style": "link"
                            },
                            {
                              "id": "86547438-03fc-43d2-a71f-411933b57ed4",
                              "cellValue": "Workload",
                              "linkTarget": "step",
                              "linkLabel": "Workload",
                              "style": "link"
                            },
                            {
                              "id": "e108180a-219f-4cf0-b36d-1331c332390f",
                              "cellValue": "ProductVersion",
                              "linkTarget": "step",
                              "linkLabel": "ProductVersion",
                              "style": "link"
                            }
                          ]
                        },
                        "name": "Scroll to step - Top"
                      },
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "toolbar",
                          "links": [
                            {
                              "id": "873b5467-459f-44be-9a24-90b65aa7ae5f",
                              "cellValue": "Scroll to step - Top",
                              "linkTarget": "step",
                              "linkLabel": "Go to top",
                              "style": "link",
                              "icon": "up"
                            }
                          ]
                        },
                        "name": "links - 21"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "selectedTab",
                    "comparison": "isEqualTo",
                    "value": "Individual Summary"
                  },
                  "name": "Individual Summary"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Count",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey == \"ITSG\"\r\n| summarize ITSG_Count = count() by ITSG=tagValue\r\n| sort by ITSG_Count desc",
                          "size": 0,
                          "title": "ITSG",
                          "exportFieldName": "ITSG",
                          "exportParameterName": "selectedITSG",
                          "exportDefaultValue": "*",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ITSG_Count",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "blue",
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": []
                                  }
                                }
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "ITSG",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, id, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey == \"ITSG\"\r\n| where tagValue == \"{selectedITSG}\"\r\n| project-away tags",
                          "size": 0,
                          "title": "ITSG - {selectedITSG} - VM List",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "id",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "subTarget": "tags",
                                  "linkIsContextBlade": true,
                                  "showIcon": true
                                }
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "ITSG - {selectedITSG} - VM List",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "____________________________________________________________________________________________________________________________________"
                        },
                        "name": "text - 6"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey == \"CostCentre\"\r\n| summarize CostCentre_Count = count() by CostCentre=tagValue\r\n| sort by CostCentre_Count desc",
                          "size": 0,
                          "title": "CostCentre",
                          "exportFieldName": "CostCentre",
                          "exportParameterName": "selectedCostCentre",
                          "exportDefaultValue": "*",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "CostCentre_Count",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "CostCentre",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, id, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey == \"CostCentre\"\r\n| where tagValue == \"{selectedCostCentre}\"\r\n| project-away tags\r\n",
                          "size": 0,
                          "title": "CostCentre- {selectedCostCentre} - VM List",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "id",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "subTarget": "tags",
                                  "linkIsContextBlade": true,
                                  "showIcon": true
                                }
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "CostCentre- {selectedCostCentre} - VM List",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "____________________________________________________________________________________________________________________________________"
                        },
                        "name": "text - 6 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey == \"Icc\"\r\n| summarize Icc_Count = count() by Icc=tagValue\r\n| sort by Icc_Count desc",
                          "size": 0,
                          "title": "Icc",
                          "exportFieldName": "Icc",
                          "exportParameterName": "selectedIcc",
                          "exportDefaultValue": "*",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Icc_Count",
                                "formatter": 3,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "Icc",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup !contains \"databricks\"\r\n| where name !contains \"aks\"\r\n| project Server=name, id, tags\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey == \"Icc\"\r\n| where tagValue == \"{selectedIcc}\"\r\n| project-away tags",
                          "size": 0,
                          "title": "Icc - {selectedIcc} - VM List",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "id",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "subTarget": "tags",
                                  "linkIsContextBlade": true,
                                  "showIcon": true
                                }
                              }
                            ],
                            "rowLimit": 10000,
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "Icc - {selectedIcc} - VM List",
                        "styleSettings": {
                          "showBorder": true
                        }
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "selectedTab",
                    "comparison": "isEqualTo",
                    "value": "Count"
                  },
                  "name": "Count"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedTab",
              "comparison": "isEqualTo",
              "value": "Virtual Machines"
            },
            "name": "Virtual Machines"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Resource Groups",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "0d2b4000-be45-4212-943b-75fe706f126b",
                        "cellValue": "selectedTab",
                        "linkTarget": "parameter",
                        "linkLabel": "Overall Summary",
                        "subTarget": "Overall Summary",
                        "style": "link"
                      },
                      {
                        "id": "deada350-4c6a-4936-8904-f45f11a3297e",
                        "cellValue": "selectedTab",
                        "linkTarget": "parameter",
                        "linkLabel": "Individual Summary",
                        "subTarget": "Individual Summary",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 8"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Name",
                          "size": 3,
                          "title": "Name",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "Name",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by ServiceName",
                          "size": 3,
                          "title": "ServiceName",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "ServiceName",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by ITSG",
                          "size": 3,
                          "title": "ITSG",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "ITSG",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by CostCentre",
                          "size": 3,
                          "title": "CostCentre",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "CostCentre",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "___________________________________________________________________________________________________________________________________________"
                        },
                        "name": "text - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Icc",
                          "size": 3,
                          "title": "Icc",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "Icc",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Platform",
                          "size": 3,
                          "title": "Platform",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "Platform",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Environment",
                          "size": 3,
                          "title": "Environment",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "Environment",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Workload",
                          "size": 3,
                          "title": "Workload",
                          "showRefreshButton": true,
                          "exportFieldName": "series",
                          "exportParameterName": "selectedNameTag",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Compliant",
                                "color": "green"
                              },
                              {
                                "seriesName": "Non-Compliant",
                                "color": "redBright"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "Workload",
                        "styleSettings": {
                          "maxWidth": "25",
                          "showBorder": true
                        }
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "selectedTab",
                    "comparison": "isEqualTo",
                    "value": "Overall Summary"
                  },
                  "name": "Overall Summary",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "nav",
                          "links": [
                            {
                              "id": "2a1cb1a6-e665-468f-a692-7319ecb2dc0e",
                              "cellValue": "Name",
                              "linkTarget": "step",
                              "linkLabel": "Name",
                              "preText": "",
                              "style": "link"
                            },
                            {
                              "id": "e74512d0-eaf8-40b9-b259-eed5cd2e9288",
                              "cellValue": "ServiceName",
                              "linkTarget": "step",
                              "linkLabel": "ServiceName",
                              "style": "link"
                            },
                            {
                              "id": "dadd786f-378e-4473-9b38-0f960cc6f528",
                              "cellValue": "ITSG",
                              "linkTarget": "step",
                              "linkLabel": "ITSG",
                              "style": "link"
                            },
                            {
                              "id": "bdc908bc-19eb-48ee-be93-ad9d14bad843",
                              "cellValue": "CostCentre",
                              "linkTarget": "step",
                              "linkLabel": "CostCentre",
                              "style": "link"
                            },
                            {
                              "id": "d0aa9961-c7a7-4f76-ab48-18a83bd3da28",
                              "cellValue": "Icc",
                              "linkTarget": "step",
                              "linkLabel": "Icc",
                              "style": "link"
                            },
                            {
                              "id": "a06bb035-cddf-489e-8a34-cf2ed340544c",
                              "cellValue": "Platform",
                              "linkTarget": "step",
                              "linkLabel": "Platform",
                              "style": "link"
                            },
                            {
                              "id": "20b7bebb-7510-424c-91a0-6a06e63448a6",
                              "cellValue": "Environment",
                              "linkTarget": "step",
                              "linkLabel": "Environment",
                              "style": "link"
                            },
                            {
                              "id": "86547438-03fc-43d2-a71f-411933b57ed4",
                              "cellValue": "Workload",
                              "linkTarget": "step",
                              "linkLabel": "Workload",
                              "style": "link"
                            }
                          ]
                        },
                        "name": "Scroll to step - Top"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "Name",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Name",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| where Name == {selectedNameTag}\r\n| project resourceGroup, [\"Tag Status\"]=Name, id",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "resourceGroup",
                                      "formatter": 14,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name - Copy",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "Name",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "ServiceName",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by ServiceName",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| where ServiceName == {selectedNameTag}\r\n| project resourceGroup, [\"Tag Status\"]=ServiceName, id",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "resourceGroup",
                                      "formatter": 14,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name - Copy",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "ServiceName",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "ITSG",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by ITSG",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| where ITSG == {selectedNameTag}\r\n| project resourceGroup, [\"Tag Status\"]=ITSG, id",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "resourceGroup",
                                      "formatter": 14,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name - Copy",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "ITSG",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "CostCentre",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by CostCentre",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| where CostCentre == {selectedNameTag}\r\n| project resourceGroup, [\"Tag Status\"]=CostCentre, id",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "resourceGroup",
                                      "formatter": 14,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name - Copy",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "CostCentre",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "Icc",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Icc",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| where Icc == {selectedNameTag}\r\n| project resourceGroup, [\"Tag Status\"]=Icc, id",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "resourceGroup",
                                      "formatter": 14,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name - Copy",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "Icc",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "Platform",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Platform",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| where Platform == {selectedNameTag}\r\n| project resourceGroup, [\"Tag Status\"]=Platform, id",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "resourceGroup",
                                      "formatter": 14,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name - Copy",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "Platform",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "Environment",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Environment",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| where Environment == {selectedNameTag}\r\n| project resourceGroup, [\"Tag Status\"]=Environment, id",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "resourceGroup",
                                      "formatter": 14,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name - Copy",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "Environment",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "Workload",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| summarize count() by Workload",
                                "size": 3,
                                "showRefreshButton": true,
                                "exportMultipleValues": true,
                                "exportedParameters": [
                                  {
                                    "fieldName": "series",
                                    "parameterName": "selectedNameTag",
                                    "parameterType": 1
                                  }
                                ],
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Compliant",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Non-Compliant",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resourcecontainers\r\n| where type == \"microsoft.resources/subscriptions/resourcegroups\"\r\n| mvexpand tags\r\n| extend tagKey = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagKey])\r\n| where tagKey in (\"Name\", \"ServiceName\", \"ITSG\", \"CostCentre\", \"Icc\", \"Platform\", \"Environment\", \"Workload\")\r\n| summarize M_tags_set = tostring(makeset(tagKey)) by resourceGroup, id\r\n| extend Name = case(M_tags_set has \"Name\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t ServiceName = case(M_tags_set has \"ServiceName\", \"Compliant\", \"Non-Compliant\"),\r\n         ITSG = case(M_tags_set has \"ITSG\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t CostCentre = case(M_tags_set has \"CostCentre\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Icc = case(M_tags_set has \"Icc\", \"Compliant\", \"Non-Compliant\"),\r\n         Platform = case(M_tags_set has \"Platform\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Environment = case(M_tags_set has \"Environment\", \"Compliant\", \"Non-Compliant\"),\r\n\t\t Workload = case(M_tags_set has \"Workload\", \"Compliant\", \"Non-Compliant\")\r\n| where Workload == {selectedNameTag}\r\n| project resourceGroup, [\"Tag Status\"]=Workload, id",
                                "size": 0,
                                "exportFieldName": "series",
                                "exportParameterName": "selectedTag",
                                "showExportToExcel": true,
                                "exportToExcelOptions": "all",
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscriptions}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "resourceGroup",
                                      "formatter": 14,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Tag Status",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Compliant",
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Non-Compliant",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "more",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "id",
                                      "formatter": 13,
                                      "formatOptions": {
                                        "linkTarget": "Resource",
                                        "subTarget": "tags",
                                        "linkIsContextBlade": true,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "rowLimit": 10000
                                },
                                "chartSettings": {
                                  "showLegend": true,
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Tag Added",
                                      "label": "Compliance ",
                                      "color": "green"
                                    },
                                    {
                                      "seriesName": "Tag Not Added",
                                      "label": "Non-Compliance",
                                      "color": "redBright"
                                    }
                                  ],
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "Name - Copy",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            }
                          ]
                        },
                        "name": "Workload",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "nav",
                          "links": [
                            {
                              "id": "2a1cb1a6-e665-468f-a692-7319ecb2dc0e",
                              "cellValue": "Name",
                              "linkTarget": "step",
                              "linkLabel": "Name",
                              "preText": "",
                              "style": "link"
                            },
                            {
                              "id": "e74512d0-eaf8-40b9-b259-eed5cd2e9288",
                              "cellValue": "ServiceName",
                              "linkTarget": "step",
                              "linkLabel": "ServiceName",
                              "style": "link"
                            },
                            {
                              "id": "dadd786f-378e-4473-9b38-0f960cc6f528",
                              "cellValue": "ITSG",
                              "linkTarget": "step",
                              "linkLabel": "ITSG",
                              "style": "link"
                            },
                            {
                              "id": "bdc908bc-19eb-48ee-be93-ad9d14bad843",
                              "cellValue": "CostCentre",
                              "linkTarget": "step",
                              "linkLabel": "CostCentre",
                              "style": "link"
                            },
                            {
                              "id": "d0aa9961-c7a7-4f76-ab48-18a83bd3da28",
                              "cellValue": "Icc",
                              "linkTarget": "step",
                              "linkLabel": "Icc",
                              "style": "link"
                            },
                            {
                              "id": "a06bb035-cddf-489e-8a34-cf2ed340544c",
                              "cellValue": "Platform",
                              "linkTarget": "step",
                              "linkLabel": "Platform",
                              "style": "link"
                            },
                            {
                              "id": "20b7bebb-7510-424c-91a0-6a06e63448a6",
                              "cellValue": "Environment",
                              "linkTarget": "step",
                              "linkLabel": "Environment",
                              "style": "link"
                            },
                            {
                              "id": "86547438-03fc-43d2-a71f-411933b57ed4",
                              "cellValue": "Workload",
                              "linkTarget": "step",
                              "linkLabel": "Workload",
                              "style": "link"
                            }
                          ]
                        },
                        "name": "Scroll to step - Top"
                      },
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "toolbar",
                          "links": [
                            {
                              "id": "873b5467-459f-44be-9a24-90b65aa7ae5f",
                              "cellValue": "Scroll to step - Top",
                              "linkTarget": "step",
                              "linkLabel": "Go to top",
                              "style": "link",
                              "icon": "up"
                            }
                          ]
                        },
                        "name": "links - 21"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "selectedTab",
                    "comparison": "isEqualTo",
                    "value": "Individual Summary"
                  },
                  "name": "Individual Summary"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedTab",
              "comparison": "isEqualTo",
              "value": "Resource Groups"
            },
            "name": "Resource Groups"
          }
        ]
      },
      "name": "group - 22",
      "styleSettings": {
        "showBorder": true
      }
    }
  ],
  "fallbackResourceIds": [
    "Azure Monitor"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
